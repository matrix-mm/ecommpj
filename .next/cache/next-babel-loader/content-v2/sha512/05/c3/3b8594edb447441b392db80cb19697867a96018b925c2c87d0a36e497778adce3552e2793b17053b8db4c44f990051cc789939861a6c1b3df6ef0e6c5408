{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _slicedToArray from \"C:/Users/thetn/OneDrive/Desktop/ecommpj/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"C:/Users/thetn/OneDrive/Desktop/ecommpj/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/thetn/OneDrive/Desktop/ecommpj/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\thetn\\\\OneDrive\\\\Desktop\\\\ecommpj\\\\pages\\\\checkout.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport getCommerce from '../utils/commerce';\nimport Layout from '../components/Layout';\nimport { Box, Button, Card, CircularProgress, FormControl, Grid, InputLabel, List, ListItem, MenuItem, Select, Step, StepLabel, Stepper, TextField, Typography } from '@material-ui/core';\nimport { useStyles } from '../utils/styles';\nimport { Store } from '../components/Store';\nimport Router from 'next/router';\nimport { ORDER_SET } from '../utils/constants';\nimport dynamic from 'next/dynamic';\nimport { Alert } from '@material-ui/lab';\nvar dev = true || true; // remove \"|| true\" in production\n\nfunction Checkout(props) {\n  _s();\n\n  var _this = this;\n\n  var classes = useStyles();\n\n  var _useContext = useContext(Store),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var cart = state.cart;\n\n  var _useState = useState([]),\n      errors = _useState[0],\n      setErrors = _useState[1];\n\n  var _useState2 = useState({}),\n      checkoutToken = _useState2[0],\n      setCheckoutToken = _useState2[1]; // Customer details\n\n\n  var _useState3 = useState(dev ? 'Jane' : ''),\n      firstName = _useState3[0],\n      setFirstName = _useState3[1];\n\n  var _useState4 = useState(dev ? 'Doe' : ''),\n      lastName = _useState4[0],\n      setLastName = _useState4[1];\n\n  var _useState5 = useState(dev ? 'janedoe@email.com' : ''),\n      email = _useState5[0],\n      setEmail = _useState5[1]; // Shipping details\n\n\n  var _useState6 = useState(dev ? 'Jane Doe' : ''),\n      shippingName = _useState6[0],\n      setShippingName = _useState6[1];\n\n  var _useState7 = useState(dev ? '123 Fake St' : ''),\n      shippingStreet = _useState7[0],\n      setShippingStreet = _useState7[1];\n\n  var _useState8 = useState(dev ? 'Los Angeles' : ''),\n      shippingCity = _useState8[0],\n      setShippingCity = _useState8[1];\n\n  var _useState9 = useState(dev ? 'AR' : ''),\n      shippingStateProvince = _useState9[0],\n      setShippingStateProvince = _useState9[1];\n\n  var _useState10 = useState(dev ? '90089' : ''),\n      shippingPostalZipCode = _useState10[0],\n      setShippingPostalZipCode = _useState10[1];\n\n  var _useState11 = useState(dev ? 'GB' : ''),\n      shippingCountry = _useState11[0],\n      setShippingCountry = _useState11[1]; // Payment details\n\n\n  var _useState12 = useState(dev ? '4242 4242 4242 4242' : ''),\n      cardNum = _useState12[0],\n      setCardNum = _useState12[1];\n\n  var _useState13 = useState(dev ? '11' : ''),\n      expMonth = _useState13[0],\n      setExpMonth = _useState13[1];\n\n  var _useState14 = useState(dev ? '2023' : ''),\n      expYear = _useState14[0],\n      setExpYear = _useState14[1];\n\n  var _useState15 = useState(dev ? '123' : ''),\n      cvv = _useState15[0],\n      setCvv = _useState15[1];\n\n  var _useState16 = useState(dev ? '90089' : ''),\n      billingPostalZipcode = _useState16[0],\n      setBillingPostalZipcode = _useState16[1]; // Shipping and fulfillment data\n\n\n  var _useState17 = useState({}),\n      shippingCountries = _useState17[0],\n      setShippingCountries = _useState17[1];\n\n  var _useState18 = useState({}),\n      shippingSubdivisions = _useState18[0],\n      setShippingSubdivisions = _useState18[1];\n\n  var _useState19 = useState([]),\n      shippingOptions = _useState19[0],\n      setShippingOptions = _useState19[1];\n\n  var _useState20 = useState({}),\n      shippingOption = _useState20[0],\n      setShippingOption = _useState20[1];\n\n  useEffect(function () {\n    if (!cart.loading) {\n      generateCheckoutToken();\n    }\n  }, [cart.loading]);\n\n  var generateCheckoutToken = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var commerce, token;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!cart.data.line_items.length) {\n                _context.next = 9;\n                break;\n              }\n\n              commerce = getCommerce(props.commercePublicKey);\n              _context.next = 4;\n              return commerce.checkout.generateToken(cart.data.id, {\n                type: 'cart'\n              });\n\n            case 4:\n              token = _context.sent;\n              setCheckoutToken(token);\n              fetchShippingCountries(token.id);\n              _context.next = 10;\n              break;\n\n            case 9:\n              Router.push('/cart');\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function generateCheckoutToken() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var fetchShippingCountries = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(checkoutTokenId) {\n      var commerce, countries;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              commerce = getCommerce(props.commercePublicKey);\n              _context2.next = 3;\n              return commerce.services.localeListShippingCountries(checkoutTokenId);\n\n            case 3:\n              countries = _context2.sent;\n              setShippingCountries(countries.countries);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function fetchShippingCountries(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var fetchSubdivisions = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(countryCode) {\n      var commerce, subdivisions;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              commerce = getCommerce(props.commercePublicKey);\n              _context3.next = 3;\n              return commerce.services.localeListSubdivisions(countryCode);\n\n            case 3:\n              subdivisions = _context3.sent;\n              setShippingSubdivisions(subdivisions.subdivisions);\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function fetchSubdivisions(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var fetchShippingOptions = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(checkoutTokenId, country) {\n      var stateProvince,\n          commerce,\n          options,\n          shippingOption,\n          _args4 = arguments;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              stateProvince = _args4.length > 2 && _args4[2] !== undefined ? _args4[2] : null;\n              commerce = getCommerce(props.commercePublicKey);\n              _context4.next = 4;\n              return commerce.checkout.getShippingOptions(checkoutTokenId, {\n                country: country,\n                region: stateProvince\n              });\n\n            case 4:\n              options = _context4.sent;\n              shippingOption = options[0] ? options[0].id : null;\n              setShippingOption(shippingOption);\n              setShippingOptions(options);\n              console.log(shippingOption);\n\n            case 9:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function fetchShippingOptions(_x3, _x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handleShippingCountryChange = function handleShippingCountryChange(e) {\n    var currentValue = e.target.value;\n    setShippingCountry(e.target.value);\n    fetchSubdivisions(currentValue);\n  };\n\n  var handleSubdivisionChange = function handleSubdivisionChange(e) {\n    var currentValue = e.target.value;\n    setShippingStateProvince(currentValue);\n    fetchShippingOptions(checkoutToken.id, shippingCountry, currentValue);\n  };\n\n  var handleShippingOptionChange = function handleShippingOptionChange(e) {\n    var currentValue = e.target.value;\n    setShippingOption(currentValue);\n    console.log(currentValue);\n  };\n\n  var handleCaptureCheckout = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var orderData, commerce, order, errList, errs, index;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              orderData = {\n                line_items: checkoutToken.live.line_items,\n                customer: {\n                  firstname: firstName,\n                  lastname: lastName,\n                  email: email\n                },\n                shipping: {\n                  name: shippingName,\n                  street: shippingStreet,\n                  town_city: shippingCity,\n                  county_state: shippingStateProvince,\n                  postal_zip_code: shippingPostalZipCode,\n                  country: shippingCountry\n                },\n                fulfillment: {\n                  shipping_method: shippingOption\n                },\n                payment: {\n                  gateway: 'test_gateway',\n                  card: {\n                    number: cardNum,\n                    expiry_month: expMonth,\n                    expiry_year: expYear,\n                    cvc: cvv,\n                    postal_zip_code: billingPostalZipcode\n                  }\n                }\n              };\n              commerce = getCommerce(props.commercePublicKey);\n              _context5.prev = 2;\n              _context5.next = 5;\n              return commerce.checkout.capture(checkoutToken.id, orderData);\n\n            case 5:\n              order = _context5.sent;\n              dispatch({\n                type: ORDER_SET,\n                payload: order\n              });\n              localStorage.setItem('order_receipt', JSON.stringify(order));\n              _context5.next = 10;\n              return refreshCart();\n\n            case 10:\n              Router.push('/confirmation');\n              _context5.next = 19;\n              break;\n\n            case 13:\n              _context5.prev = 13;\n              _context5.t0 = _context5[\"catch\"](2);\n              errList = [_context5.t0.data.error.message];\n              errs = _context5.t0.data.error.errors;\n\n              for (index in errs) {\n                errList.push(\"\".concat(index, \": \").concat(errs[index]));\n              }\n\n              setErrors(errList);\n\n            case 19:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[2, 13]]);\n    }));\n\n    return function handleCaptureCheckout() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var refreshCart = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      var commerce;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              commerce = getCommerce(props.commercePublicKey);\n              commerce.cart.refresh().then(function (newCart) {\n                _this.setState({\n                  cart: newCart\n                });\n              })[\"catch\"](function (error) {\n                console.log('There was an error refreshing your cart', error);\n              });\n\n            case 2:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function refreshCart() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var _React$useState = React.useState(0),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activeStep = _React$useState2[0],\n      setActiveStep = _React$useState2[1];\n\n  var steps = getSteps();\n\n  var handleNext = function handleNext() {\n    setActiveStep(function (prevActiveStep) {\n      return prevActiveStep + 1;\n    });\n\n    if (activeStep === steps.length - 1) {\n      handleCaptureCheckout();\n    }\n  };\n\n  var handleBack = function handleBack() {\n    setErrors([]);\n    setActiveStep(function (prevActiveStep) {\n      return prevActiveStep - 1;\n    });\n  };\n\n  function getSteps() {\n    return ['Customer information', 'Shipping details', 'Payment information'];\n  }\n\n  function getStepContent(step) {\n    var _this2 = this;\n\n    switch (step) {\n      case 0:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"firstName\",\n            label: \"First Name\",\n            name: \"firstName\",\n            value: firstName,\n            onChange: function onChange(e) {\n              return setFirstName(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"lastName\",\n            label: \"Last Name\",\n            name: \"lastName\",\n            value: lastName,\n            onChange: function onChange(e) {\n              return setLastName(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"email\",\n            label: \"Email\",\n            name: \"email\",\n            value: email,\n            onChange: function onChange(e) {\n              return setEmail(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n\n      case 1:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"shippingName\",\n            label: \"Full Name\",\n            name: \"name\",\n            value: shippingName,\n            onChange: function onChange(e) {\n              return setShippingName(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"shippingStreet\",\n            label: \"Street\",\n            name: \"address\",\n            value: shippingStreet,\n            onChange: function onChange(e) {\n              return setShippingStreet(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"shippingCity\",\n            label: \"City\",\n            name: \"city\",\n            value: shippingCity,\n            onChange: function onChange(e) {\n              return setShippingCity(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"shippingPostalZipCode\",\n            label: \"Postal/Zip Code\",\n            name: \"postalCode\",\n            value: shippingPostalZipCode,\n            onChange: function onChange(e) {\n              return setShippingPostalZipCode(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n            className: classes.formControl,\n            children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n              id: \"shippingCountry-label\",\n              children: \"Country\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              labelId: \"shippingCountry-label\",\n              id: \"shippingCountry\",\n              label: \"Country\",\n              fullWidth: true,\n              onChange: handleShippingCountryChange,\n              value: shippingCountry,\n              children: Object.keys(shippingCountries).map(function (index) {\n                return /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: index,\n                  children: shippingCountries[index]\n                }, index, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 324,\n                  columnNumber: 19\n                }, _this2);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n            className: classes.formControl,\n            children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n              id: \"shippingStateProvince-label\",\n              children: \"State / Province\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              labelId: \"shippingStateProvince-label\",\n              id: \"shippingStateProvince\",\n              label: \"State/Province\",\n              fullWidth: true,\n              onChange: handleSubdivisionChange,\n              value: shippingStateProvince,\n              required: true,\n              className: classes.mt1,\n              children: Object.keys(shippingSubdivisions).map(function (index) {\n                return /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: index,\n                  children: shippingSubdivisions[index]\n                }, index, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 19\n                }, _this2);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n            className: classes.formControl,\n            children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n              id: \"shippingOption-label\",\n              children: \"Shipping Option\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              labelId: \"shippingOption-label\",\n              id: \"shippingOption\",\n              label: \"Shipping Option\",\n              fullWidth: true,\n              onChange: handleShippingOptionChange,\n              value: shippingOption,\n              required: true,\n              className: classes.mt1,\n              children: shippingOptions.map(function (method, index) {\n                return /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: method.id,\n                  children: \"\".concat(method.description, \" - $\").concat(method.price.formatted_with_code)\n                }, index, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 366,\n                  columnNumber: 19\n                }, _this2);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n\n      case 2:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"cardNum\",\n            label: \"Card Number\",\n            name: \"cardNum\",\n            value: cardNum,\n            onChange: function onChange(e) {\n              return setCardNum(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"expMonth\",\n            label: \"Expiry Month\",\n            name: \"expMonth\",\n            value: expMonth,\n            onChange: function onChange(e) {\n              return setExpMonth(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"expYear\",\n            label: \"Expiry Year\",\n            name: \"expYear\",\n            value: expYear,\n            onChange: function onChange(e) {\n              return setExpYear(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"cvv\",\n            label: \"CVV\",\n            name: \"cvv\",\n            value: cvv,\n            onChange: function onChange(e) {\n              return setCvv(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            variant: \"outlined\",\n            margin: \"normal\",\n            required: true,\n            fullWidth: true,\n            id: \"billingPostalZipcode\",\n            label: \"Postal/Zip Code\",\n            name: \"postalCode\",\n            value: billingPostalZipcode,\n            onChange: function onChange(e) {\n              return setBillingPostalZipcode(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n\n      default:\n        return 'Unknown step';\n    }\n  }\n\n  var renderCheckoutForm = function renderCheckoutForm() {\n    return /*#__PURE__*/_jsxDEV(\"form\", {\n      children: [/*#__PURE__*/_jsxDEV(Stepper, {\n        activeStep: activeStep,\n        alternativeLabel: true,\n        children: steps.map(function (label) {\n          return /*#__PURE__*/_jsxDEV(Step, {\n            children: /*#__PURE__*/_jsxDEV(StepLabel, {\n              children: label\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 15\n            }, _this)\n          }, label, false, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 13\n          }, _this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Box, {\n        children: activeStep === steps.length ? errors && errors.length > 0 ? /*#__PURE__*/_jsxDEV(Box, {\n          children: [/*#__PURE__*/_jsxDEV(List, {\n            children: errors.map(function (error) {\n              return /*#__PURE__*/_jsxDEV(ListItem, {\n                children: /*#__PURE__*/_jsxDEV(Alert, {\n                  severity: \"error\",\n                  children: error\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 457,\n                  columnNumber: 23\n                }, _this)\n              }, error, false, {\n                fileName: _jsxFileName,\n                lineNumber: 456,\n                columnNumber: 21\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 17\n          }, _this), /*#__PURE__*/_jsxDEV(Box, {\n            className: classes.mt1,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              onClick: handleBack,\n              className: classes.button,\n              children: \"Back\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 19\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 17\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 15\n        }, _this) : /*#__PURE__*/_jsxDEV(Box, {\n          children: [/*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 17\n          }, _this), /*#__PURE__*/_jsxDEV(Typography, {\n            className: classes.instructions,\n            children: \"Confirming Order...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 470,\n            columnNumber: 17\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 15\n        }, _this) : /*#__PURE__*/_jsxDEV(Box, {\n          children: [getStepContent(activeStep), /*#__PURE__*/_jsxDEV(Box, {\n            className: classes.mt1,\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              disabled: activeStep === 0,\n              onClick: handleBack,\n              className: classes.button,\n              children: \"Back\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"contained\",\n              color: \"primary\",\n              onClick: handleNext,\n              className: classes.button,\n              children: activeStep === steps.length - 1 ? 'Confirm Order' : 'Next'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 478,\n            columnNumber: 15\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 7\n    }, _this);\n  };\n\n  var renderCheckoutSummary = function renderCheckoutSummary() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(List, {\n        children: [/*#__PURE__*/_jsxDEV(ListItem, {\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h2\",\n            children: \"Order summary\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 11\n        }, _this), cart.data.line_items.map(function (lineItem) {\n          return /*#__PURE__*/_jsxDEV(ListItem, {\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              children: [/*#__PURE__*/_jsxDEV(Grid, {\n                xs: 6,\n                item: true,\n                children: [lineItem.quantity, \" x \", lineItem.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 513,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(Grid, {\n                xs: 6,\n                item: true,\n                children: /*#__PURE__*/_jsxDEV(Typography, {\n                  align: \"right\",\n                  children: lineItem.line_total.formatted_with_symbol\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 517,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 516,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 15\n            }, _this)\n          }, lineItem.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 13\n          }, _this);\n        }), /*#__PURE__*/_jsxDEV(ListItem, {\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            children: [/*#__PURE__*/_jsxDEV(Grid, {\n              xs: 6,\n              item: true,\n              children: \"Subtotal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 526,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(Grid, {\n              xs: 6,\n              item: true,\n              children: /*#__PURE__*/_jsxDEV(Typography, {\n                align: \"right\",\n                children: cart.data.subtotal.formatted_with_symbol\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 530,\n                columnNumber: 17\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 529,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    title: \"Checkout\",\n    commercePublicKey: props.commercePublicKey,\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      gutterBottom: true,\n      variant: \"h6\",\n      color: \"textPrimary\",\n      component: \"h1\",\n      children: \"Checkout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 543,\n      columnNumber: 7\n    }, this), cart.loading ? /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 547,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 8,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: classes.p1,\n          children: renderCheckoutForm()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 551,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 550,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        md: 4,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: renderCheckoutSummary()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 542,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Checkout, \"LhJ0UezrtVLwYabde7B2qWMpXe4=\", false, function () {\n  return [useStyles];\n});\n\n_c = Checkout;\nexport default _c3 = dynamic(_c2 = function _c2() {\n  return Promise.resolve(Checkout);\n}, {\n  ssr: false\n});\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Checkout\");\n$RefreshReg$(_c2, \"%default%$dynamic\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"sources":["C:/Users/thetn/OneDrive/Desktop/ecommpj/pages/checkout.js"],"names":["React","useContext","useEffect","useState","getCommerce","Layout","Box","Button","Card","CircularProgress","FormControl","Grid","InputLabel","List","ListItem","MenuItem","Select","Step","StepLabel","Stepper","TextField","Typography","useStyles","Store","Router","ORDER_SET","dynamic","Alert","dev","Checkout","props","classes","state","dispatch","cart","errors","setErrors","checkoutToken","setCheckoutToken","firstName","setFirstName","lastName","setLastName","email","setEmail","shippingName","setShippingName","shippingStreet","setShippingStreet","shippingCity","setShippingCity","shippingStateProvince","setShippingStateProvince","shippingPostalZipCode","setShippingPostalZipCode","shippingCountry","setShippingCountry","cardNum","setCardNum","expMonth","setExpMonth","expYear","setExpYear","cvv","setCvv","billingPostalZipcode","setBillingPostalZipcode","shippingCountries","setShippingCountries","shippingSubdivisions","setShippingSubdivisions","shippingOptions","setShippingOptions","shippingOption","setShippingOption","loading","generateCheckoutToken","data","line_items","length","commerce","commercePublicKey","checkout","generateToken","id","type","token","fetchShippingCountries","push","checkoutTokenId","services","localeListShippingCountries","countries","fetchSubdivisions","countryCode","localeListSubdivisions","subdivisions","fetchShippingOptions","country","stateProvince","getShippingOptions","region","options","console","log","handleShippingCountryChange","e","currentValue","target","value","handleSubdivisionChange","handleShippingOptionChange","handleCaptureCheckout","orderData","live","customer","firstname","lastname","shipping","name","street","town_city","county_state","postal_zip_code","fulfillment","shipping_method","payment","gateway","card","number","expiry_month","expiry_year","cvc","capture","order","payload","localStorage","setItem","JSON","stringify","refreshCart","errList","error","message","errs","index","refresh","then","newCart","setState","activeStep","setActiveStep","steps","getSteps","handleNext","prevActiveStep","handleBack","getStepContent","step","formControl","Object","keys","map","mt1","method","description","price","formatted_with_code","renderCheckoutForm","label","button","instructions","renderCheckoutSummary","lineItem","quantity","line_total","formatted_with_symbol","subtotal","p1","Promise","resolve","ssr"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport getCommerce from '../utils/commerce';\nimport Layout from '../components/Layout';\nimport {\n  Box,\n  Button,\n  Card,\n  CircularProgress,\n  FormControl,\n  Grid,\n  InputLabel,\n  List,\n  ListItem,\n  MenuItem,\n  Select,\n  Step,\n  StepLabel,\n  Stepper,\n  TextField,\n  Typography,\n} from '@material-ui/core';\nimport { useStyles } from '../utils/styles';\nimport { Store } from '../components/Store';\nimport Router from 'next/router';\nimport { ORDER_SET } from '../utils/constants';\nimport dynamic from 'next/dynamic';\nimport { Alert } from '@material-ui/lab';\nconst dev = process.env.NODE_ENV === 'development' || true; // remove \"|| true\" in production\nfunction Checkout(props) {\n  const classes = useStyles();\n\n  const { state, dispatch } = useContext(Store);\n  const { cart } = state;\n\n  const [errors, setErrors] = useState([]);\n  const [checkoutToken, setCheckoutToken] = useState({});\n  // Customer details\n  const [firstName, setFirstName] = useState(dev ? 'Jane' : '');\n  const [lastName, setLastName] = useState(dev ? 'Doe' : '');\n  const [email, setEmail] = useState(dev ? 'janedoe@email.com' : '');\n  // Shipping details\n  const [shippingName, setShippingName] = useState(dev ? 'Jane Doe' : '');\n  const [shippingStreet, setShippingStreet] = useState(\n    dev ? '123 Fake St' : ''\n  );\n  const [shippingCity, setShippingCity] = useState(dev ? 'Los Angeles' : '');\n  const [shippingStateProvince, setShippingStateProvince] = useState(\n    dev ? 'AR' : ''\n  );\n  const [shippingPostalZipCode, setShippingPostalZipCode] = useState(\n    dev ? '90089' : ''\n  );\n  const [shippingCountry, setShippingCountry] = useState(dev ? 'GB' : '');\n  // Payment details\n  const [cardNum, setCardNum] = useState(dev ? '4242 4242 4242 4242' : '');\n  const [expMonth, setExpMonth] = useState(dev ? '11' : '');\n  const [expYear, setExpYear] = useState(dev ? '2023' : '');\n  const [cvv, setCvv] = useState(dev ? '123' : '');\n  const [billingPostalZipcode, setBillingPostalZipcode] = useState(\n    dev ? '90089' : ''\n  );\n  // Shipping and fulfillment data\n  const [shippingCountries, setShippingCountries] = useState({});\n  const [shippingSubdivisions, setShippingSubdivisions] = useState({});\n  const [shippingOptions, setShippingOptions] = useState([]);\n  const [shippingOption, setShippingOption] = useState({});\n\n  useEffect(() => {\n    if (!cart.loading) {\n      generateCheckoutToken();\n    }\n  }, [cart.loading]);\n  const generateCheckoutToken = async () => {\n    if (cart.data.line_items.length) {\n      const commerce = getCommerce(props.commercePublicKey);\n      const token = await commerce.checkout.generateToken(cart.data.id, {\n        type: 'cart',\n      });\n      setCheckoutToken(token);\n      fetchShippingCountries(token.id);\n    } else {\n      Router.push('/cart');\n    }\n  };\n\n  const fetchShippingCountries = async (checkoutTokenId) => {\n    const commerce = getCommerce(props.commercePublicKey);\n    const countries = await commerce.services.localeListShippingCountries(\n      checkoutTokenId\n    );\n    setShippingCountries(countries.countries);\n  };\n\n  const fetchSubdivisions = async (countryCode) => {\n    const commerce = getCommerce(props.commercePublicKey);\n    const subdivisions = await commerce.services.localeListSubdivisions(\n      countryCode\n    );\n    setShippingSubdivisions(subdivisions.subdivisions);\n  };\n\n  const fetchShippingOptions = async (\n    checkoutTokenId,\n    country,\n    stateProvince = null\n  ) => {\n    const commerce = getCommerce(props.commercePublicKey);\n    const options = await commerce.checkout.getShippingOptions(\n      checkoutTokenId,\n      {\n        country: country,\n        region: stateProvince,\n      }\n    );\n\n    const shippingOption = options[0] ? options[0].id : null;\n    setShippingOption(shippingOption);\n    setShippingOptions(options);\n    console.log(shippingOption);\n  };\n\n  const handleShippingCountryChange = (e) => {\n    const currentValue = e.target.value;\n    setShippingCountry(e.target.value);\n    fetchSubdivisions(currentValue);\n  };\n\n  const handleSubdivisionChange = (e) => {\n    const currentValue = e.target.value;\n    setShippingStateProvince(currentValue);\n    fetchShippingOptions(checkoutToken.id, shippingCountry, currentValue);\n  };\n\n  const handleShippingOptionChange = (e) => {\n    const currentValue = e.target.value;\n    setShippingOption(currentValue);\n    console.log(currentValue);\n  };\n\n  const handleCaptureCheckout = async () => {\n    const orderData = {\n      line_items: checkoutToken.live.line_items,\n      customer: {\n        firstname: firstName,\n        lastname: lastName,\n        email: email,\n      },\n      shipping: {\n        name: shippingName,\n        street: shippingStreet,\n        town_city: shippingCity,\n        county_state: shippingStateProvince,\n        postal_zip_code: shippingPostalZipCode,\n        country: shippingCountry,\n      },\n      fulfillment: {\n        shipping_method: shippingOption,\n      },\n      payment: {\n        gateway: 'test_gateway',\n        card: {\n          number: cardNum,\n          expiry_month: expMonth,\n          expiry_year: expYear,\n          cvc: cvv,\n          postal_zip_code: billingPostalZipcode,\n        },\n      },\n    };\n\n    const commerce = getCommerce(props.commercePublicKey);\n    try {\n      const order = await commerce.checkout.capture(\n        checkoutToken.id,\n        orderData\n      );\n      dispatch({ type: ORDER_SET, payload: order });\n      localStorage.setItem('order_receipt', JSON.stringify(order));\n      await refreshCart();\n      Router.push('/confirmation');\n    } catch (err) {\n      const errList = [err.data.error.message];\n      const errs = err.data.error.errors;\n      for (const index in errs) {\n        errList.push(`${index}: ${errs[index]}`);\n      }\n      setErrors(errList);\n    }\n  };\n\n  const refreshCart = async () => {\n    const commerce = getCommerce(props.commercePublicKey);\n\n    commerce.cart\n      .refresh()\n      .then((newCart) => {\n        this.setState({\n          cart: newCart,\n        });\n      })\n      .catch((error) => {\n        console.log('There was an error refreshing your cart', error);\n      });\n  };\n\n  const [activeStep, setActiveStep] = React.useState(0);\n  const steps = getSteps();\n\n  const handleNext = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n\n    if (activeStep === steps.length - 1) {\n      handleCaptureCheckout();\n    }\n  };\n\n  const handleBack = () => {\n    setErrors([]);\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  function getSteps() {\n    return ['Customer information', 'Shipping details', 'Payment information'];\n  }\n\n  function getStepContent(step) {\n    switch (step) {\n      case 0:\n        return (\n          <>\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"firstName\"\n              label=\"First Name\"\n              name=\"firstName\"\n              value={firstName}\n              onChange={(e) => setFirstName(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"lastName\"\n              label=\"Last Name\"\n              name=\"lastName\"\n              value={lastName}\n              onChange={(e) => setLastName(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"email\"\n              label=\"Email\"\n              name=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n            />\n          </>\n        );\n      case 1:\n        return (\n          <>\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"shippingName\"\n              label=\"Full Name\"\n              name=\"name\"\n              value={shippingName}\n              onChange={(e) => setShippingName(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"shippingStreet\"\n              label=\"Street\"\n              name=\"address\"\n              value={shippingStreet}\n              onChange={(e) => setShippingStreet(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"shippingCity\"\n              label=\"City\"\n              name=\"city\"\n              value={shippingCity}\n              onChange={(e) => setShippingCity(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"shippingPostalZipCode\"\n              label=\"Postal/Zip Code\"\n              name=\"postalCode\"\n              value={shippingPostalZipCode}\n              onChange={(e) => setShippingPostalZipCode(e.target.value)}\n            />\n            <FormControl className={classes.formControl}>\n              <InputLabel id=\"shippingCountry-label\">Country</InputLabel>\n              <Select\n                labelId=\"shippingCountry-label\"\n                id=\"shippingCountry\"\n                label=\"Country\"\n                fullWidth\n                onChange={handleShippingCountryChange}\n                value={shippingCountry}\n              >\n                {Object.keys(shippingCountries).map((index) => (\n                  <MenuItem value={index} key={index}>\n                    {shippingCountries[index]}\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n            <FormControl className={classes.formControl}>\n              <InputLabel id=\"shippingStateProvince-label\">\n                State / Province\n              </InputLabel>\n\n              <Select\n                labelId=\"shippingStateProvince-label\"\n                id=\"shippingStateProvince\"\n                label=\"State/Province\"\n                fullWidth\n                onChange={handleSubdivisionChange}\n                value={shippingStateProvince}\n                required\n                className={classes.mt1}\n              >\n                {Object.keys(shippingSubdivisions).map((index) => (\n                  <MenuItem value={index} key={index}>\n                    {shippingSubdivisions[index]}\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n            <FormControl className={classes.formControl}>\n              <InputLabel id=\"shippingOption-label\">Shipping Option</InputLabel>\n\n              <Select\n                labelId=\"shippingOption-label\"\n                id=\"shippingOption\"\n                label=\"Shipping Option\"\n                fullWidth\n                onChange={handleShippingOptionChange}\n                value={shippingOption}\n                required\n                className={classes.mt1}\n              >\n                {shippingOptions.map((method, index) => (\n                  <MenuItem\n                    value={method.id}\n                    key={index}\n                  >{`${method.description} - $${method.price.formatted_with_code}`}</MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n          </>\n        );\n      case 2:\n        return (\n          <>\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"cardNum\"\n              label=\"Card Number\"\n              name=\"cardNum\"\n              value={cardNum}\n              onChange={(e) => setCardNum(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"expMonth\"\n              label=\"Expiry Month\"\n              name=\"expMonth\"\n              value={expMonth}\n              onChange={(e) => setExpMonth(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"expYear\"\n              label=\"Expiry Year\"\n              name=\"expYear\"\n              value={expYear}\n              onChange={(e) => setExpYear(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"cvv\"\n              label=\"CVV\"\n              name=\"cvv\"\n              value={cvv}\n              onChange={(e) => setCvv(e.target.value)}\n            />\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              required\n              fullWidth\n              id=\"billingPostalZipcode\"\n              label=\"Postal/Zip Code\"\n              name=\"postalCode\"\n              value={billingPostalZipcode}\n              onChange={(e) => setBillingPostalZipcode(e.target.value)}\n            />\n          </>\n        );\n      default:\n        return 'Unknown step';\n    }\n  }\n\n  const renderCheckoutForm = () => {\n    return (\n      <form>\n        <Stepper activeStep={activeStep} alternativeLabel>\n          {steps.map((label) => (\n            <Step key={label}>\n              <StepLabel>{label}</StepLabel>\n            </Step>\n          ))}\n        </Stepper>\n        <Box>\n          {activeStep === steps.length ? (\n            errors && errors.length > 0 ? (\n              <Box>\n                <List>\n                  {errors.map((error) => (\n                    <ListItem key={error}>\n                      <Alert severity=\"error\">{error}</Alert>\n                    </ListItem>\n                  ))}\n                </List>\n                <Box className={classes.mt1}>\n                  <Button onClick={handleBack} className={classes.button}>\n                    Back\n                  </Button>\n                </Box>\n              </Box>\n            ) : (\n              <Box>\n                <CircularProgress />\n                <Typography className={classes.instructions}>\n                  Confirming Order...\n                </Typography>\n              </Box>\n            )\n          ) : (\n            <Box>\n              {getStepContent(activeStep)}\n              <Box className={classes.mt1}>\n                <Button\n                  disabled={activeStep === 0}\n                  onClick={handleBack}\n                  className={classes.button}\n                >\n                  Back\n                </Button>\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  onClick={handleNext}\n                  className={classes.button}\n                >\n                  {activeStep === steps.length - 1 ? 'Confirm Order' : 'Next'}\n                </Button>\n              </Box>\n            </Box>\n          )}\n        </Box>\n      </form>\n    );\n  };\n\n  const renderCheckoutSummary = () => {\n    return (\n      <>\n        <List>\n          <ListItem>\n            <Typography variant=\"h2\">Order summary</Typography>\n          </ListItem>\n\n          {cart.data.line_items.map((lineItem) => (\n            <ListItem key={lineItem.id}>\n              <Grid container>\n                <Grid xs={6} item>\n                  {lineItem.quantity} x {lineItem.name}\n                </Grid>\n                <Grid xs={6} item>\n                  <Typography align=\"right\">\n                    {lineItem.line_total.formatted_with_symbol}\n                  </Typography>\n                </Grid>\n              </Grid>\n            </ListItem>\n          ))}\n          <ListItem>\n            <Grid container>\n              <Grid xs={6} item>\n                Subtotal\n              </Grid>\n              <Grid xs={6} item>\n                <Typography align=\"right\">\n                  {cart.data.subtotal.formatted_with_symbol}\n                </Typography>\n              </Grid>\n            </Grid>\n          </ListItem>\n        </List>\n      </>\n    );\n  };\n\n  return (\n    <Layout title=\"Checkout\" commercePublicKey={props.commercePublicKey}>\n      <Typography gutterBottom variant=\"h6\" color=\"textPrimary\" component=\"h1\">\n        Checkout\n      </Typography>\n      {cart.loading ? (\n        <CircularProgress />\n      ) : (\n        <Grid container spacing={2}>\n          <Grid item md={8}>\n            <Card className={classes.p1}>{renderCheckoutForm()}</Card>\n          </Grid>\n          <Grid item md={4}>\n            <Card>{renderCheckoutSummary()}</Card>\n          </Grid>\n        </Grid>\n      )}\n    </Layout>\n  );\n}\nexport default dynamic(() => Promise.resolve(Checkout), {\n  ssr: false,\n});\n"]},"metadata":{},"sourceType":"module"}