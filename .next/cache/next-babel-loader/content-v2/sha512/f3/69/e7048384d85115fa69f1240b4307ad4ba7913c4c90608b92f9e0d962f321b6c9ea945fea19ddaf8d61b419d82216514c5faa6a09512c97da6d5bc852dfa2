{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _toConsumableArray from \"C:/Users/thetn/OneDrive/Desktop/ecommpj/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/Users/thetn/OneDrive/Desktop/ecommpj/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/thetn/OneDrive/Desktop/ecommpj/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useContext, useState } from 'react';\nimport { Alert } from '@material-ui/lab';\nimport getCommerce from '../../utils/commerce';\nimport { Box, Button, Card, Grid, List, ListItem, MenuItem, Select, Slide, Typography } from '@material-ui/core';\nimport { useStyles } from '../../utils/styles';\nimport Layout from '../../components/Layout';\nimport { Store } from '../../components/Store';\nimport Router from 'next/router';\nimport { CART_RETRIEVE_SUCCESS } from '../../utils/constants';\nexport var __N_SSP = true;\nexport default function Home(props) {\n  var classes = useStyles();\n\n  var _useContext = useContext(Store),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var userInfo = state.userInfo,\n      cart = state.cart;\n\n  var _useState = useState(1),\n      quantity = _useState[0],\n      setQuantity = _useState[1];\n\n  var product = props.product;\n\n  var addToCartHandler = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var commerce, lineItem, cartData, _cartData;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              commerce = getCommerce(props.commercePublicKey);\n              lineItem = cart.data.line_items.find(function (x) {\n                return x.product_id === product.id;\n              });\n\n              if (!lineItem) {\n                _context.next = 10;\n                break;\n              }\n\n              _context.next = 5;\n              return commerce.cart.update(lineItem.id, {\n                quantity: quantity\n              });\n\n            case 5:\n              cartData = _context.sent;\n              dispatch({\n                type: CART_RETRIEVE_SUCCESS,\n                payload: cartData.cart\n              });\n              Router.push('/cart');\n              _context.next = 15;\n              break;\n\n            case 10:\n              _context.next = 12;\n              return commerce.cart.add(product.id, quantity);\n\n            case 12:\n              _cartData = _context.sent;\n              dispatch({\n                type: CART_RETRIEVE_SUCCESS,\n                payload: _cartData.cart\n              });\n              Router.push('/cart');\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function addToCartHandler() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsx(Layout, {\n    userInfo: userInfo,\n    title: product.name,\n    commercePublicKey: props.commercePublicKey,\n    children: /*#__PURE__*/_jsx(Slide, {\n      direction: \"up\",\n      \"in\": true,\n      children: /*#__PURE__*/_jsxs(Grid, {\n        container: true,\n        spacing: 1,\n        children: [/*#__PURE__*/_jsx(Grid, {\n          item: true,\n          md: 6,\n          children: /*#__PURE__*/_jsx(\"img\", {\n            src: product.media.source,\n            alt: product.name,\n            className: classes.largeImage\n          })\n        }), /*#__PURE__*/_jsx(Grid, {\n          item: true,\n          md: 3,\n          xs: 12,\n          children: /*#__PURE__*/_jsxs(List, {\n            children: [/*#__PURE__*/_jsx(ListItem, {\n              children: /*#__PURE__*/_jsx(Typography, {\n                gutterBottom: true,\n                variant: \"h6\",\n                color: \"textPrimary\",\n                component: \"h1\",\n                children: product.name\n              })\n            }), /*#__PURE__*/_jsx(ListItem, {\n              children: /*#__PURE__*/_jsx(Box, {\n                dangerouslySetInnerHTML: {\n                  __html: product.description\n                }\n              })\n            })]\n          })\n        }), /*#__PURE__*/_jsx(Grid, {\n          item: true,\n          md: 3,\n          xs: 12,\n          children: /*#__PURE__*/_jsx(Card, {\n            children: /*#__PURE__*/_jsxs(List, {\n              children: [/*#__PURE__*/_jsx(ListItem, {\n                children: /*#__PURE__*/_jsxs(Grid, {\n                  container: true,\n                  children: [/*#__PURE__*/_jsx(Grid, {\n                    item: true,\n                    xs: 6,\n                    children: \"Price\"\n                  }), /*#__PURE__*/_jsx(Grid, {\n                    item: true,\n                    xs: 6,\n                    children: product.price.formatted_with_symbol\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(ListItem, {\n                children: /*#__PURE__*/_jsxs(Grid, {\n                  alignItems: \"center\",\n                  container: true,\n                  children: [/*#__PURE__*/_jsx(Grid, {\n                    item: true,\n                    xs: 6,\n                    children: \"Status\"\n                  }), /*#__PURE__*/_jsx(Grid, {\n                    item: true,\n                    xs: 6,\n                    children: product.quantity > 0 ? /*#__PURE__*/_jsx(Alert, {\n                      icon: false,\n                      severity: \"success\",\n                      children: \"In Stock\"\n                    }) : /*#__PURE__*/_jsx(Alert, {\n                      icon: false,\n                      severity: \"error\",\n                      children: \"Unavailable\"\n                    })\n                  })]\n                })\n              }), product.quantity > 0 && /*#__PURE__*/_jsxs(_Fragment, {\n                children: [/*#__PURE__*/_jsx(ListItem, {\n                  children: /*#__PURE__*/_jsxs(Grid, {\n                    container: true,\n                    justify: \"flex-end\",\n                    children: [/*#__PURE__*/_jsx(Grid, {\n                      item: true,\n                      xs: 6,\n                      children: \"Quantity\"\n                    }), /*#__PURE__*/_jsx(Grid, {\n                      item: true,\n                      xs: 6,\n                      children: /*#__PURE__*/_jsx(Select, {\n                        labelId: \"quanitity-label\",\n                        id: \"quanitity\",\n                        fullWidth: true,\n                        onChange: function onChange(e) {\n                          return setQuantity(e.target.value);\n                        },\n                        value: quantity,\n                        children: _toConsumableArray(Array(product.quantity).keys()).map(function (x) {\n                          return /*#__PURE__*/_jsx(MenuItem, {\n                            value: x + 1,\n                            children: x + 1\n                          }, x + 1);\n                        })\n                      })\n                    })]\n                  })\n                }), /*#__PURE__*/_jsx(ListItem, {\n                  children: /*#__PURE__*/_jsx(Button, {\n                    type: \"button\",\n                    fullWidth: true,\n                    variant: \"contained\",\n                    color: \"primary\",\n                    onClick: addToCartHandler,\n                    children: \"Add to cart\"\n                  })\n                })]\n              })]\n            })\n          })\n        })]\n      })\n    }, product.name)\n  });\n}","map":null,"metadata":{},"sourceType":"module"}